---
ID: "c01b3c38-db86-4f1a-a2fa-6cea43e969bf"
Parent: "277f7c07-f249-43fb-896c-5bde84cfb71b"
Template: "dd22f1b3-bd87-4db2-9e7d-f7a496888d43"
Path: /sitecore/system/Modules/PowerShell/Script Library/Custom Tools/Content Editor/Context Menu/Update Content Hub Host Name
SharedFields:
- ID: "06d5295c-ed2f-4a54-9bf2-26228d113318"
  Hint: __Icon
  Value: Applications/16x16/edit.png
- ID: "1c76313e-3c8c-4807-a826-135d10c39299"
  Hint: ShowRule
  Value: |
    <ruleset>
      <rule
        uid="{3C5482D4-0408-4055-AD27-6188E4E642F0}">
        <conditions>
          <condition
            id="{D0810F9D-734C-452D-BBB6-4730368D68F1}"
            uid="AD599D5F54724FD18B15EAE8434C49C9"
            templateid="{A2B9FDC3-F641-4966-94A5-B63944DC39DE}" />
        </conditions>
      </rule>
    </ruleset>
- ID: "b1a94ff0-6897-47c0-9c51-aa6acb80b1f0"
  Hint: Script
  Value: |
    # 1. Capture the item you right-clicked on
    $contextItem = $SitecoreContextItem 
    
    # 2. Create the User Interface Dialog
    $dialogProps = @{
        Title = "Content Hub URL Migrator"
        Description = "This tool will search and replace hostnames for: $($contextItem.Paths.FullPath)"
        Width = 550
        Height = 400
        OkButtonName = "Run Migration"
        CancelButtonName = "Cancel"
        Parameters = @(
            @{ Name = "oldHost"; Value="starter-verticals.sitecoresandbox.cloud"; Title="Current Hostname (Old)"; Tooltip="Enter the hostname you want to find."},
            @{ Name = "newHost"; Value=""; Title="New Hostname"; Tooltip="Enter the new Content Hub hostname."; Placeholder="e.g. ranula-test.sitecore.cloud"}
        )
    }
    
    # 3. Display the window to the user
    $result = Read-Variable @dialogProps
    
    # 4. Cancel if the user clicks 'Cancel'
    if($result -ne "ok") { 
        Write-Host "Operation cancelled by user."
        Exit 
    }
    
    # 5. Safety check for empty input
    if([string]::IsNullOrWhiteSpace($newHost)) {
        Show-Alert "Error: You must enter a New Hostname to proceed."
        Exit
    }
    
    # 6. Execute Search and Replace
    Write-Host "Starting migration for $($contextItem.Name)..." -ForegroundColor Cyan
    $items = Get-ChildItem -Path "master:$($contextItem.Paths.FullPath)" -Recurse
    $updateCount = 0
    
    foreach ($item in $items) {
        $itemIsDirty = $false
        foreach ($field in $item.Fields | Where-Object { $_.Value -like "*$oldHost*" }) {
            if (!$itemIsDirty) { 
                $item.Editing.BeginEdit()
                $itemIsDirty = $true 
            }
            $field.Value = $field.Value.Replace($oldHost, $newHost)
            Write-Host "Updated field '$($field.Name)' on item: $($item.Name)" -ForegroundColor Yellow
        }
        if ($itemIsDirty) { 
            $item.Editing.EndEdit()
            $updateCount++ 
        }
    }
    
    # 7. Final Notification
    Show-Alert "Finished! $updateCount items were updated under $($contextItem.Name). "
- ID: "dbbbeca1-21c7-4906-9dd2-493c1efa59a2"
  Hint: __Shared revision
  Value: "466f3114-d882-423c-ab8c-25020cae9095"
Languages:
- Language: en
  Versions:
  - Version: 1
    Fields:
    - ID: "25bed78c-4957-4165-998a-ca1b52f67497"
      Hint: __Created
      Value: 20251223T131905Z
    - ID: "52807595-0f8f-4b20-8d2a-cb71d28c6103"
      Hint: __Owner
      Value: |
        sitecore\ranula.gamage@sitecore.com
    - ID: "5dd74568-4d4b-44c1-b513-0af5f4cda34f"
      Hint: __Created by
      Value: |
        sitecore\ranula.gamage@sitecore.com
    - ID: "8cdc337e-a112-42fb-bbb4-4143751e123f"
      Hint: __Revision
      Value: "8b3b7c38-5feb-4161-a484-f6c8356b2b9e"
    - ID: "badd9cf9-53e0-4d0c-bcc0-2d784c282f6a"
      Hint: __Updated by
      Value: |
        sitecore\ranula.gamage@sitecore.com
    - ID: "d9cf14b1-fa16-4ba6-9288-e8a174d4d522"
      Hint: __Updated
      Value: 20251223T192705Z
